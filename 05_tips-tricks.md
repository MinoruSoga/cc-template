# Claude Code Tips & Tricks

## 効率的な使い方

### 1. Thinking モードの活用

複雑なタスクには thinking モードを使う：

```
think: このアーキテクチャの問題点を分析して
think harder: リファクタリング計画を立てて
ultrathink: セキュリティ監査をして
```

`Tab` キーで thinking モードのオン/オフを切り替え可能。

### 2. @メンションでコンテキストを追加

```
@src/main.ts このファイルの問題点を教えて
@src/components/ このフォルダ内のコンポーネントを整理して
```

### 3. バックグラウンドコマンド

開発サーバーなど、長時間実行するコマンドは `Ctrl + B` でバックグラウンド実行：

```
npm run dev
# Ctrl + B でバックグラウンドへ
```

### 4. 会話の継続

```bash
# 前回の会話を継続
claude --continue

# 特定の会話を再開
claude --resume
```

---

## プロンプトのコツ

### 明確な指示を出す

悪い例:
```
このコードを直して
```

良い例:
```
src/utils/api.ts の fetchData 関数で、
エラーハンドリングが不足しています。
try-catch を追加して、ネットワークエラー時に
適切なエラーメッセージを返すようにしてください。
```

### 制約を明示する

```
以下の制約で実装してください：
- 既存の API を変更しない
- TypeScript の strict モードに対応
- テストも追加する
```

### 段階的に依頼する

1つの大きなタスクより、小さなタスクに分割：

```
1. まず現状のコードを分析して
2. 次に改善点をリストアップして
3. 最後に1つずつ修正して
```

---

## パフォーマンス最適化

### コンテキストの管理

- `/compact` で会話を圧縮
- `/clear` で新しい会話を開始
- 不要なファイルを @メンションしない

### 大きなファイルの扱い

```
# ファイル全体ではなく特定の部分だけ見せる
src/api.ts の 100-200 行目を見て
```

### Auto-accept モード

信頼できる変更は `Shift + Tab` で Auto-accept を有効に：
- コード変更を自動承認
- 作業が高速化

---

## トラブルシューティング

### Claude が遅い・応答しない

1. `/compact` で会話を圧縮
2. `/clear` で新しい会話を開始
3. Claude Code を再起動

### ファイル編集がうまくいかない

```
# 具体的な行番号を指定
src/main.ts の 50 行目の console.log を削除して
```

### MCP が動作しない

```
/mcp  # 状態を確認
```

- 「connecting...」が続く → MCP サーバーを再起動
- 「failed」→ 設定を確認

### 権限エラー

```
/permissions  # 権限設定を確認・追加
```

---

## カスタマイズ例

### よく使うコマンドをスラッシュコマンド化

**~/.claude/commands/pr.md**
```markdown
---
description: PR を作成
---

現在のブランチの変更を確認し、
適切なタイトルと説明で PR を作成してください。
```

### プロジェクト固有の指示

**CLAUDE.md**
```markdown
# プロジェクト規約

## コーディングスタイル
- インデント: 2スペース
- セミコロン: なし
- クォート: シングル

## 禁止事項
- any 型の使用
- console.log の残置
```

---

## 便利な組み合わせ

### Git + Claude Code

```bash
# 変更をコミット
git add . && claude "この変更に適切なコミットメッセージを作成して"

# PR レビュー
claude "現在のブランチの変更をレビューして"
```

### VSCode + Claude Code

1. VSCode で Claude Code 拡張をインストール
2. サイドバーから Claude Code を使用
3. コードを選択して Claude に質問

---

## セキュリティのベストプラクティス

1. **API キーを直接プロンプトに書かない**
2. **機密ファイルを @メンションしない**
3. **Auto-accept は信頼できる操作のみ**
4. **定期的に権限設定を見直す**

```bash
# 許可されている権限を確認
/permissions
```
