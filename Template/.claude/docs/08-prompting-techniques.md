# 効果的なプロンプト技法

## 具体的な指示を出す

### 悪い例（曖昧）
```
テストを追加して
```

### 良い例（具体的）
```
foo.pyに新しいテストケースを作成してください。
ログアウト状態のエッジケースをカバーしてください。
```

---

## Extended Thinking（拡張思考）の使い分け

| レベル | キーワード | 用途 |
|--------|----------|------|
| 軽量 | `think` | 単純な問題、クイックな修正 |
| 中程度 | `think hard` | 複雑な設計判断 |
| 深い | `think harder` | アーキテクチャ決定 |
| 最深 | `ultrathink` | 全体最適化、大規模リファクタ |

### 使用例
```
think hard: このAPIの認証方式をJWTからOAuthに変更する設計を考えて
```

**切り替え:** `Tab` キーで思考モードを切り替え

---

## 探索→計画→実装→コミット サイクル

```
┌─────────┐     ┌─────────┐     ┌─────────┐     ┌─────────┐
│  探索   │ ──▶ │  計画   │ ──▶ │  実装   │ ──▶ │ コミット │
└─────────┘     └─────────┘     └─────────┘     └─────────┘
```

### 探索フェーズ
```
関連ファイルを読み込んで、現状の実装を分析してください。
この段階ではコードを書かないでください。
```

### 計画フェーズ
```
think hard: 先ほどの分析を踏まえて、実装計画を立ててください。
```

### 実装フェーズ
```
計画に従って実装を進めてください。
各ステップで動作確認をしながら進めてください。
```

### コミットフェーズ
```
変更内容に基づいてコミットメッセージを生成し、コミットしてください。
```

---

## Plan Mode（計画モード）

複雑な変更には **Plan Mode** が推奨されます：

```bash
# Shift+Tab で切り替え
# または起動時に指定
claude --permission-mode plan
```

### 使用場面
- 複数ファイルへの実装
- コードベース探索
- アーキテクチャ設計

---

## ファイル参照（@構文）

```bash
# ファイル参照
> Explain the logic in @src/utils/auth.js

# ディレクトリ参照
> What's the structure of @src/components?

# 外部リソース参照（MCP）
> Show me the data from @github:repos/owner/repo/issues
```

---

## 効果的なプロンプトパターン

### コードベース理解
```
このコードベースの概要を説明してください
このプロジェクトで使用している技術は何ですか？
ログインプロセスをフロントエンドからデータベースまで追跡してください
```

### バグ修正
```
npm testを実行するとエラーが発生します
user.tsの@ts-ignoreを修正する方法を提案してください
提案したnullチェックを追加してuser.tsを更新してください
```

### リファクタリング
```
非推奨APIの使用箇所をコードベースから探してください
同じ動作を維持しながらutils.jsをES2024機能を使用するようにリファクタリングしてください
リファクタリングしたコードのテストを実行してください
```

### テスト作成
```
NotificationsService.swiftでテストされていない関数を探してください
通知サービスのテストを追加してください
エッジケースのテストケースを追加してください
```

---

## アンチパターン

### 避けるべきこと

1. **曖昧な指示**
   - ❌ 「コードを改善して」
   - ✅ 「この関数のエラーハンドリングを追加して」

2. **複数の無関係なタスクを同時に**
   - ❌ 「テストを追加して、ドキュメントも書いて、リファクタリングもして」
   - ✅ 1つずつ依頼する

3. **コンテキストなしの依頼**
   - ❌ 「バグを直して」
   - ✅ 「npm testを実行すると〇〇エラーが出ます。修正してください」

4. **過度に制約的な指示**
   - ❌ 「必ず3行以内で書いて」
   - ✅ 「簡潔に書いて」

---

## 段階的アプローチ

複雑なタスクは段階的に進めることで、より良い結果が得られます：

```
1. まず現状を理解
> このファイルの構造を説明してください

2. 計画を立てる
> この機能を追加するための計画を立ててください

3. 実装
> 計画のステップ1を実装してください

4. 検証
> テストを実行して動作を確認してください

5. 次のステップ
> ステップ2を実装してください
```
